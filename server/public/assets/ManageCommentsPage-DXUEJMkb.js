import{$ as k,a0 as w,j as r,r as a,s as c,B as x,C as h,a6 as y,P as E,v as o,T as L,L as C,I as _,i as P,af as O}from"./index-BpWeeXno.js";import{d as T}from"./OpenInNew-BclhptO5.js";import{a as B,f as A,l as H,b as F,r as G}from"./commentService-B5sfTTRX.js";import{T as N,a as Y,b as I,c as m,d as i,e as J}from"./TableRow-eGBFD1to.js";import{L as $}from"./Link-TyrU6qHP.js";var f={},K=k;Object.defineProperty(f,"__esModule",{value:!0});var z=f.default=void 0,Q=K(w()),U=r;z=f.default=(0,Q.default)((0,U.jsx)("path",{d:"M16.59 7.58 10 14.17l-3.59-3.58L5 12l5 5 8-8zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"}),"CheckCircleOutline");var u={},V=k;Object.defineProperty(u,"__esModule",{value:!0});var S=u.default=void 0,X=V(w()),Z=r;S=u.default=(0,X.default)((0,Z.jsx)("path",{d:"M14.59 8 12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"HighlightOff");const ae=()=>{const[j,d]=a.useState([]),[M,p]=a.useState(!0),[g,v]=a.useState(null),[l,n]=a.useState({}),b=a.useCallback(async()=>{p(!0),v(null);try{const e=await B();d(e)}catch(e){const s=e.message||"Şərhlər gətirilərkən xəta baş verdi.";console.error("Gözləyən şərhləri gətirmə xətası:",e),v(s),c(s)}finally{p(!1)}},[]);a.useEffect(()=>{b()},[b]);const R=async e=>{n(s=>({...s,[e]:"approve"}));try{await F(e),P(`Şərh #${e} təsdiq edildi.`),d(s=>s.filter(t=>t.id!==e))}catch(s){const t=s.message||`Şərh #${e} təsdiq edilərkən xəta baş verdi.`;console.error(`Şərh #${e} təsdiq etmə xətası:`,s),c(t)}finally{n(s=>({...s,[e]:!1}))}},q=async e=>{n(s=>({...s,[e]:"reject"}));try{await G(e),O(`Şərh #${e} rədd edildi.`),d(s=>s.filter(t=>t.id!==e))}catch(s){const t=s.message||`Şərh #${e} rədd edilərkən xəta baş verdi.`;console.error(`Şərh #${e} rədd etmə xətası:`,s),c(t)}finally{n(s=>({...s,[e]:!1}))}},W=e=>{try{return A(new Date(e),{addSuffix:!0,locale:H})}catch(s){return console.error("Tarix formatlama xətası:",s),e}},D=()=>M?r.jsx(x,{sx:{display:"flex",justifyContent:"center",alignItems:"center",py:5},children:r.jsx(h,{})}):g?r.jsx(y,{severity:"error",sx:{mt:2},children:g}):j.length===0?r.jsx(y,{severity:"info",sx:{mt:2},children:"Təsdiq gözləyən şərh yoxdur."}):r.jsx(N,{component:E,elevation:2,sx:{mt:2},children:r.jsxs(Y,{sx:{minWidth:650},"aria-label":"gözləyən şərhlər cədvəli",children:[r.jsx(I,{sx:{backgroundColor:"action.hover"},children:r.jsxs(m,{children:[r.jsx(i,{sx:{fontWeight:"bold"},children:"ID"}),r.jsx(i,{sx:{fontWeight:"bold"},children:"Yazar"}),r.jsx(i,{sx:{fontWeight:"bold"},children:"Şərh"}),r.jsx(i,{sx:{fontWeight:"bold"},children:"Film Başlığı"}),r.jsx(i,{sx:{fontWeight:"bold"},children:"Tarix"}),r.jsx(i,{align:"center",sx:{fontWeight:"bold"},children:"Əməliyyatlar"})]})}),r.jsx(J,{children:j.map(e=>{var s;return r.jsxs(m,{sx:{"&:last-child td, &:last-child th":{border:0}},hover:!0,children:[r.jsx(i,{component:"th",scope:"row",children:e.id}),r.jsx(i,{children:((s=e.author)==null?void 0:s.username)||`İstifadəçi #${e.user_id}`}),r.jsx(i,{children:r.jsx(o,{title:e.content,arrow:!0,children:r.jsx(L,{variant:"body2",noWrap:!0,sx:{maxWidth:"300px"},children:e.content})})}),r.jsx(i,{children:e.movieTitle?r.jsx(o,{title:`IMDb ID: ${e.movie_imdb_id}`,arrow:!0,children:r.jsxs($,{component:C,to:`/movie/${e.movie_imdb_id}`,target:"_blank",rel:"noopener noreferrer",underline:"hover",sx:{display:"inline-flex",alignItems:"center"},children:[e.movieTitle,r.jsx(T,{sx:{fontSize:"0.9rem",ml:.5,opacity:.6}})]})}):r.jsxs($,{component:C,to:`/movie/${e.movie_imdb_id}`,target:"_blank",rel:"noopener noreferrer",underline:"hover",sx:{display:"inline-flex",alignItems:"center"},children:[e.movie_imdb_id,r.jsx(T,{sx:{fontSize:"0.9rem",ml:.5}})]})}),r.jsx(i,{children:W(e.created_at)}),r.jsx(i,{align:"center",children:r.jsxs(x,{sx:{display:"flex",justifyContent:"center",gap:1},children:[r.jsx(o,{title:"Təsdiq Et",children:r.jsxs("span",{children:[" ",r.jsx(_,{color:"success",onClick:()=>R(e.id),disabled:!!l[e.id],size:"small",children:l[e.id]==="approve"?r.jsx(h,{size:20,color:"inherit"}):r.jsx(z,{})})]})}),r.jsx(o,{title:"Rədd Et",children:r.jsxs("span",{children:[" ",r.jsx(_,{color:"error",onClick:()=>q(e.id),disabled:!!l[e.id],size:"small",children:l[e.id]==="reject"?r.jsx(h,{size:20,color:"inherit"}):r.jsx(S,{})})]})})]})})]},e.id)})})]})});return r.jsx(x,{sx:{p:{xs:2,sm:3}},children:D()})};export{ae as default};
